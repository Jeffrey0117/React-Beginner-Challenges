# è§£ç­”ï¼šsetState é€£çºŒå‘¼å«å•é¡Œ

## ğŸŸ¢ è§£æ±ºæ–¹æ¡ˆ

### âœ… æ–¹æ³•1ï¼šä½¿ç”¨å‡½æ•¸å¼æ›´æ–°ï¼ˆæ¨è–¦ï¼‰

```jsx
const handleMultipleUpdates = () => {
  setCount(prevCount => prevCount + 1)  // åŸºæ–¼å‰ä¸€å€‹å€¼
  setCount(prevCount => prevCount + 1)  // åŸºæ–¼å‰ä¸€å€‹å€¼
  setCount(prevCount => prevCount + 1)  // åŸºæ–¼å‰ä¸€å€‹å€¼
  setCount(prevCount => prevCount + 1)  // åŸºæ–¼å‰ä¸€å€‹å€¼
  setCount(prevCount => prevCount + 1)  // åŸºæ–¼å‰ä¸€å€‹å€¼
  // æœ€çµ‚çµæœï¼š5
}
```

### âœ… æ–¹æ³•2ï¼šä¸€æ¬¡æ€§è¨ˆç®—ï¼ˆæœ€ä½³è§£æ³•ï¼‰

```jsx
const handleMultipleUpdates = () => {
  setCount(count + 5)  // ç›´æ¥åŠ 5
}
```

## ğŸ§  åŸç†è§£é‡‹

### **å•é¡Œ1ï¼šé–‰åŒ…é™·é˜±**

```jsx
const [count, setCount] = useState(0)  // count = 0

const handleClick = () => {
  // é€™å€‹å‡½æ•¸é–‰åŒ…æ•ç²äº†ç•¶å‰çš„ count å€¼ (0)
  setCount(count + 1)  // å¯¦éš›ä¸Šæ˜¯ setCount(0 + 1)
  setCount(count + 1)  // å¯¦éš›ä¸Šæ˜¯ setCount(0 + 1)
  setCount(count + 1)  // å¯¦éš›ä¸Šæ˜¯ setCount(0 + 1)
  // æœ€å¾Œä¸€å€‹æœƒè¦†è“‹å‰é¢çš„ï¼Œçµæœé‚„æ˜¯ 1
}
```

### **å•é¡Œ2ï¼šReact çš„æ‰¹æ¬¡æ›´æ–°**

- React æœƒå°‡åŒä¸€å€‹äº‹ä»¶è™•ç†å™¨ä¸­çš„å¤šå€‹ setState æ‰¹æ¬¡è™•ç†
- ç›¸åŒçš„ç‹€æ…‹æ›´æ–°æœƒè¢«åˆä½µï¼Œå¾Œé¢çš„è¦†è“‹å‰é¢çš„

### **è§£æ±ºåŸç†ï¼šå‡½æ•¸å¼æ›´æ–°**

```jsx
setCount(prevCount => prevCount + 1)
// React å…§éƒ¨æœƒé€™æ¨£åŸ·è¡Œï¼š
// ç¬¬1æ¬¡ï¼šprevCount = 0 â†’ è¿”å› 1
// ç¬¬2æ¬¡ï¼šprevCount = 1 â†’ è¿”å› 2  
// ç¬¬3æ¬¡ï¼šprevCount = 2 â†’ è¿”å› 3
// ...ä¾æ­¤é¡æ¨
```

## ğŸ“š æ ¸å¿ƒæ¦‚å¿µ

### **1. JavaScript é–‰åŒ…**
```jsx
function Counter() {
  const [count, setCount] = useState(0)
  
  const handleClick = () => {
    // é€™è£¡çš„ count æ˜¯é–‰åŒ…æ•ç²çš„å€¼ï¼Œä¸æœƒè‡ªå‹•æ›´æ–°
    console.log('é–‰åŒ…ä¸­çš„ count:', count)  // æ°¸é æ˜¯é»æ“Šæ™‚çš„å€¼
  }
  
  return <button onClick={handleClick}>Count: {count}</button>
}
```

### **2. React æ‰¹æ¬¡æ›´æ–°**
```jsx
// React 18 ä¹‹å‰
function handleClick() {
  setCount(count + 1)  // æ‰¹æ¬¡æ›´æ–°é–‹å§‹
  setName('John')      // åŠ å…¥æ‰¹æ¬¡
  setAge(25)           // åŠ å…¥æ‰¹æ¬¡
  // æ‰¹æ¬¡æ›´æ–°çµæŸï¼Œçµ±ä¸€é‡æ–°æ¸²æŸ“
}

// çµæœï¼šåªé‡æ–°æ¸²æŸ“ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯ä¸‰æ¬¡
```

### **3. å‡½æ•¸å¼æ›´æ–°çš„å„ªå‹¢**
```jsx
// âŒ å•é¡Œï¼šåŸºæ–¼èˆŠå€¼
const increment5Times = () => {
  const currentCount = count  // 0
  setCount(currentCount + 1)  // è¨­å®šç‚º 1
  setCount(currentCount + 1)  // è¨­å®šç‚º 1 (è¦†è“‹)
  setCount(currentCount + 1)  // è¨­å®šç‚º 1 (è¦†è“‹)
}

// âœ… è§£æ±ºï¼šåŸºæ–¼æœ€æ–°å€¼
const increment5Times = () => {
  setCount(prev => prev + 1)  // 0 + 1 = 1
  setCount(prev => prev + 1)  // 1 + 1 = 2
  setCount(prev => prev + 1)  // 2 + 1 = 3
}
```

## ğŸ’¡ å¯¦ç”¨æŠ€å·§

### **è¤‡é›œç‹€æ…‹æ›´æ–°**
```jsx
// âœ… åœ¨å‡½æ•¸å¼æ›´æ–°ä¸­è™•ç†è¤‡é›œé‚è¼¯
setCount(prevCount => {
  const newValue = prevCount + calculateIncrement()
  
  // å¯ä»¥æ·»åŠ æ¢ä»¶åˆ¤æ–·
  if (newValue > 100) {
    return 100  // é™åˆ¶æœ€å¤§å€¼
  }
  
  // å¯ä»¥æ·»åŠ æ—¥èªŒ
  console.log(`Count updated from ${prevCount} to ${newValue}`)
  
  return newValue
})
```

### **å¤šå€‹ç‹€æ…‹åŒæ™‚æ›´æ–°**
```jsx
// å¦‚æœéœ€è¦åŸºæ–¼ç•¶å‰ç‹€æ…‹æ›´æ–°å¤šå€‹ç‹€æ…‹
const handleComplexUpdate = () => {
  setCount(prevCount => {
    const newCount = prevCount + 1
    
    // åŸºæ–¼æ–°çš„ count å€¼æ›´æ–°å…¶ä»–ç‹€æ…‹
    setProgress((newCount / maxCount) * 100)
    
    return newCount
  })
}
```

## ğŸ” èª¿è©¦æŠ€å·§

```jsx
// ä½¿ç”¨ console.log è¿½è¹¤æ›´æ–°éç¨‹
setCount(prevCount => {
  console.log('Previous count:', prevCount)
  const newCount = prevCount + 1
  console.log('New count:', newCount)
  return newCount
})
```

---

**è¨˜ä½ï¼šç•¶éœ€è¦åŸºæ–¼ç•¶å‰ç‹€æ…‹è¨ˆç®—æ–°ç‹€æ…‹æ™‚ï¼Œæ°¸é ä½¿ç”¨å‡½æ•¸å¼æ›´æ–°ï¼** ğŸ¯
